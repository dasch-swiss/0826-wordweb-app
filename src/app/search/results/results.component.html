<div class="result-container" fxFlex.gt-sm="550px" fxFill>

    <div *ngIf="passages" fxLayout="column" fxLayoutGap="10px">
        <div fxLayout="row" fxLayoutAlign="space-between center">
            <div>{{passages.length}} <span *ngIf="nPassages | async as total"> of {{total}} results</span></div>
            <mat-form-field>
                <mat-label>Sort</mat-label>
                <mat-select [(ngModel)]="sortOrder" (ngModelChange)="sortResults()">
                    <mat-option [value]="'Author'">Author</mat-option>
                    <mat-option [value]="'Title'">Title</mat-option>
                    <mat-option [value]="'Date'">Date</mat-option>
                </mat-select>
            </mat-form-field>
        </div>

        <div class="result" *ngFor="let passage of passages; let pIndex = index;">
            <div class="overview">
                <div class="numbering">{{pIndex | numbering}}</div>
                <div class="title" [innerHTML]="passage | title"></div>
                <div class="text" [innerHTML]="passage.original ? passage.hasTextHist[0].value : passage.hasText[0].value"></div>
                <div class="lexias" [innerHTML]="passage | lexias"></div>
                <div class="expand-btn">
                    <button [disabled]="false" (click)="expandOrClose(passage)">{{expandBtnText(passage)}}</button>
                </div>
            </div>

            <div class="details" [class.opened]="passage.expanded">
                <div *ngIf="!detailPassages[passage.id]" class="spinner-container">
                    <ngx-spinner name="spinner-{{passage.id}}"></ngx-spinner>
                </div>
                <div *ngIf="detailPassages[passage.id]; let detailPas">
                    <div class="comments" [innerHTML]="detailPas | comments"></div>
                    <div class="citation">
                        <div class="title">CITATION</div>
                        <div [innerHTML]="detailPas | bibliography" ></div>
                    </div>
                    <div class="source" [innerHTML]="detailPas | source: listService"></div>
                    <div class="original-btn">
                        <button *ngIf="passage.hasTextHist" (click)="originalOrNormalized(passage)">{{spellingBtnText(passage)}}</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="no-results" *ngIf="passages.length === 0">
            No results were found
        </div>

        <div class="load-more" *ngIf="nPassages | async as amount">
            <button mat-button *ngIf="(passages.length !== amount) && !searchStarted" (click)="loadMoreResults()">
                Load more
            </button>
        </div>

        <div class="spinner-small" *ngIf="searchStarted && passages.length !== 0">
            <ngx-spinner name="spinner-small"></ngx-spinner>
        </div>

    </div>

    <div class="error" *ngIf="errorObject && !searchStarted">
        <div class="img-container">
            <img src="assets/error.png" alt="Shakespeare is confused" height="128"/>
        </div>
        <div class="text">
            <div class="title">Oh no!</div>
            <div>Even Shakespeare had to deal with errors in his plays.<br>He just tried again later.</div>
        </div>
    </div>

    <div class="spinner-big" *ngIf="!passages && searchStarted">
        <ngx-spinner name="spinner-big"></ngx-spinner>
    </div>

</div>
